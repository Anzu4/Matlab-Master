function rgbi = nm2rgb(wvlngth)
nms = 370:10:650;
rods = [0 0 0 38.4 40.1 42.1 45.7 51.5 60.5 71.8 83.0 92.4 98.2 99.5 95.0  85.5 72.5 58.1 43.4 31.5 22.7 15.8 11.0 7.3 4.7 3.7 0 0 0];
blues = [59.3 65.2 74.4 87.8 97.2 99.8 95.7 85.4 69.5 50. 35.5 24.8 15.9 10.6 5.3 3.0 0 0 0 0 0 0 0 0 0 0 0 0 0];
greens = [0 0 0 39.7 38.7 38.2 37.9 39.6 42.9 48.1 55.5 63.7 73.1 82.3 90.4 96.9 99.9 98.6 92.4 82.6 70.2 56.0 42.7 31.7 23.2 15.5 11.2 7.5 0];
reds = [ 0 0 0 43.4 41.9 40.2 38.3 37.7 36.3 38.0 41.0 46.1 52.1 59.4 67.0 75.7 84.4 92.2 97.9 99.9 97.7 91.4 82.2 70.9 58.9 44.9 31.8 21.4 12.7];

r = spline(nms,reds,wvlngth);
g = spline(nms,greens,wvlngth);
b = spline(nms,blues,wvlngth);
I = spline(nms,rods,wvlngth);
rgbi = [r,g,b,I];